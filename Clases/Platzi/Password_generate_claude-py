import random
import string
import re

def generar_contrasena(longitud=12):
    """
    Genera una contraseña segura con al menos una letra mayúscula,
    una letra minúscula, un número y un carácter especial.
    
    Args:
        longitud: Longitud mínima de la contraseña (por defecto 12)
    
    Returns:
        Una contraseña segura
    """
    if longitud < 12:
        longitud = 12  # Forzar longitud mínima de 12 caracteres
    
    # Caracteres para la contraseña
    mayusculas = string.ascii_uppercase
    minusculas = string.ascii_lowercase
    numeros = string.digits
    especiales = "!@#$%^&*()_+-=[]{}|;:,.<>?~"
    
    # Lista de secuencias y patrones a evitar
    secuencias_comunes = [
        "12345", "qwerty", "abcde", "password", "admin", "letmein",
        "welcome", "iloveyou", "123abc", "monkey", "dragon", "111111"
    ]
    
    # Generar contraseña inicial con al menos un carácter de cada tipo
    pwd = [
        random.choice(mayusculas),
        random.choice(minusculas),
        random.choice(numeros),
        random.choice(especiales)
    ]
    
    # Completar la contraseña con caracteres aleatorios
    todos_caracteres = mayusculas + minusculas + numeros + especiales
    for _ in range(longitud - 4):
        pwd.append(random.choice(todos_caracteres))
    
    # Mezclar los caracteres para evitar patrones predecibles
    random.shuffle(pwd)
    contrasena = ''.join(pwd)
    
    # Verificar si la contraseña contiene secuencias comunes
    for secuencia in secuencias_comunes:
        if secuencia in contrasena.lower():
            # Si contiene una secuencia común, generar una nueva
            return generar_contrasena(longitud)
    
    # Verificar que la contraseña cumpla con todos los requisitos
    if (re.search(r'[A-Z]', contrasena) and
        re.search(r'[a-z]', contrasena) and
        re.search(r'[0-9]', contrasena) and
        re.search(r'[!@#$%^&*()_+\-=\[\]{}|;:,.<>?~]', contrasena)):
        return contrasena
    else:
        # Si no cumple con los requisitos, generar una nueva
        return generar_contrasena(longitud)

def evaluar_fortaleza(contrasena):
    """
    Evalúa la fortaleza de una contraseña.
    
    Args:
        contrasena: La contraseña a evaluar
    
    Returns:
        Un mensaje que indica la fortaleza de la contraseña
    """
    puntaje = 0
    
    # Verificar longitud
    if len(contrasena) >= 12:
        puntaje += 1
    if len(contrasena) >= 16:
        puntaje += 1
    
    # Verificar complejidad
    if re.search(r'[A-Z]', contrasena):
        puntaje += 1
    if re.search(r'[a-z]', contrasena):
        puntaje += 1
    if re.search(r'[0-9]', contrasena):
        puntaje += 1
    if re.search(r'[!@#$%^&*()_+\-=\[\]{}|;:,.<>?~]', contrasena):
        puntaje += 1
    
    # Verificar diversidad de caracteres
    if len(set(contrasena)) >= 8:
        puntaje += 1
    
    # Evaluar fortaleza
    if puntaje <= 3:
        return "Débil"
    elif puntaje <= 5:
        return "Moderada"
    else:
        return "Fuerte"

# Ejemplo de uso
if __name__ == "__main__":
    longitud_deseada = 16  # Puedes cambiar este valor
    
    contrasena = generar_contrasena(longitud_deseada)
    fortaleza = evaluar_fortaleza(contrasena)
    
    print(f"Contraseña generada: {contrasena}")
    print(f"Longitud: {len(contrasena)} caracteres")
    print(f"Fortaleza: {fortaleza}")
    
    # Generar múltiples contraseñas
    print("\nOtras contraseñas posibles:")
    for _ in range(3):
        otra_contrasena = generar_contrasena(longitud_deseada)
        print(f"- {otra_contrasena} (Fortaleza: {evaluar_fortaleza(otra_contrasena)})")



